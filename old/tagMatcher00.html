
<script>
  var testString = "<tr><td>>trala</td></tr>"
  var formattedString = '';
  var insideTag = false;
  var inOpenTag = false;
  var inCloseTag = false;
  grammarStack = [];
  // status 
  // inside an opening tag inOpenTag
  // inside a closing tag  inCloseTag
  // inbetween openning and closing tags betweenTags
  /*
    if (inOpenTag == false) {
      inOpenTag = true;
    } else {
      console.log("entering a second openning tag")
    }
  }
  */
  var curPos= 0;
  for (var i=0; i < testString.length; i++) {
    var newTag = ''
    // console.log(testString[i])
    // switch(testString[i]) {
    //   case '<':
    //     if (insideTag == true) {
    //       console.log("spurious '<' ignored");
    //     } else {
    //       insideTag = true;
    //       console.log("openning angle");
    //     }
    //     break;
    //   case '>':
    //     if (insideTag == true) {
    //       insideTag = false;
    //       console.log("closing angle");
    //     } else {
    //       console.log("spurious '>' ignored");
    //     }
    //     break;
    // }
    if (testString[i] == '<') {
      var returnVal = buildTag(testString, i);
      
    }
  }

  function buildTag(inString, position) {
    var returnTag = '<';
    var j = position+1;

    if (inString[position] != '<') {
        console.log("ERROR buildTag called incorrectly");
        return [-1, -1];
    }

    do {
      if (j == inString.length) {
        console.log("ERROR closing '>' not found")
        return [-1, -1]
      }
      returnTag += inString[j];
      i++;
    } while (inString[j-1] != '>'); 

    console.log(returnTag, j)

    return [returnTag, j]

  }



</script>